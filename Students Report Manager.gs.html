<p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * creates custom menu for student report options when opened</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">function</span> <span style="color: rgb(32, 33, 36);">onOpen</span>() {</p><p>  <span style="color: rgb(201, 39, 134);">SpreadsheetApp</span>.<span style="color: rgb(32, 33, 36);">getUi</span>().<span style="color: rgb(32, 33, 36);">createMenu</span>(<span style="color: rgb(179, 20, 18);">"Student Report"</span>)</p><p>    .<span style="color: rgb(32, 33, 36);">addItem</span>(<span style="color: rgb(179, 20, 18);">"Highest Mark"</span>, <span style="color: rgb(179, 20, 18);">"getHighestMark"</span>)</p><p>    .<span style="color: rgb(32, 33, 36);">addItem</span>(<span style="color: rgb(179, 20, 18);">"Lowest Mark"</span>, <span style="color: rgb(179, 20, 18);">"getLowestMark"</span>)</p><p>    .<span style="color: rgb(32, 33, 36);">addItem</span>(<span style="color: rgb(179, 20, 18);">"Generate Report"</span>, <span style="color: rgb(179, 20, 18);">"createReport"</span>)</p><p>    .<span style="color: rgb(32, 33, 36);">addItem</span>(<span style="color: rgb(179, 20, 18);">"Email Report"</span>, <span style="color: rgb(179, 20, 18);">"emailReport"</span>)</p><p>    .<span style="color: rgb(32, 33, 36);">addToUi</span>();</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * gets student with highest weighted average in the course and displays to user</span></p><p><span style="color: rgb(19, 115, 51);"> * called from custom menu</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">function</span> <span style="color: rgb(32, 33, 36);">getHighestMark</span>() {</p><p>  <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">sheets</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Sheets</span>();</p><p>  <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">course</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Course</span>(<span style="color: rgb(32, 33, 36);">sheets</span>);</p><p>  <span style="color: rgb(32, 33, 36);">course</span>.<span style="color: rgb(32, 33, 36);">getHighestMark</span>().<span style="color: rgb(32, 33, 36);">showInfo</span>(<span style="color: rgb(179, 20, 18);">"Highest Mark"</span>);</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * gets student with lowest weighted average in the course and displays to user</span></p><p><span style="color: rgb(19, 115, 51);"> * called from custom menu</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">function</span> <span style="color: rgb(32, 33, 36);">getLowestMark</span>() {</p><p>  <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">sheets</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Sheets</span>();</p><p>  <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">course</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Course</span>(<span style="color: rgb(32, 33, 36);">sheets</span>);</p><p>  <span style="color: rgb(32, 33, 36);">course</span>.<span style="color: rgb(32, 33, 36);">getLowestMark</span>().<span style="color: rgb(32, 33, 36);">showInfo</span>(<span style="color: rgb(179, 20, 18);">"Lowest Mark"</span>);</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * creates a report for a given student on google docs</span></p><p><span style="color: rgb(19, 115, 51);"> * called from custom menu</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">function</span> <span style="color: rgb(32, 33, 36);">createReport</span>() {</p><p>  <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">sheets</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Sheets</span>();</p><p>  <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">report</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Report</span>(<span style="color: rgb(32, 33, 36);">sheets</span>);</p><p>  <span style="color: rgb(32, 33, 36);">report</span>.<span style="color: rgb(32, 33, 36);">createReport</span>()</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * creates a report for a given student on google docs and emails it to their parents through gmail</span></p><p><span style="color: rgb(19, 115, 51);"> * called from custom menu</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">function</span> <span style="color: rgb(32, 33, 36);">emailReport</span>() {</p><p>  <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">sheets</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Sheets</span>();</p><p>  <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">report</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Report</span>(<span style="color: rgb(32, 33, 36);">sheets</span>);</p><p>  <span style="color: rgb(32, 33, 36);">report</span>.<span style="color: rgb(32, 33, 36);">mailReport</span>()</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * abstract class of data from all the sheets in the spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">class</span> <span style="color: rgb(201, 39, 134);">Sheet</span> {</p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * gets sheets from spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {object} spreadsheet - the currently opened spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {array} sheet - all the sheets in the current spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(24, 90, 188);">constructor</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">spreadsheet</span> = <span style="color: rgb(201, 39, 134);">SpreadsheetApp</span>.<span style="color: rgb(32, 33, 36);">getActiveSpreadsheet</span>();</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">spreadsheet</span>.<span style="color: rgb(32, 33, 36);">getSheets</span>();</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">if</span> (<span style="color: rgb(24, 90, 188);">new</span>.<span style="color: rgb(32, 33, 36);">target</span> === <span style="color: rgb(201, 39, 134);">Sheet</span>) {</p><p>      <span style="color: rgb(24, 90, 188);">throw</span> <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Error</span>(<span style="color: rgb(179, 20, 18);">"Error: Abstract class"</span>);</p><p>    }</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * abstract method to get needed data from sheet(s)</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">getData</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">throw</span> <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Error</span>(<span style="color: rgb(179, 20, 18);">"Error: Abstract method"</span>);</p><p>  }</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * class for the sheet with student information (first sheet)</span></p><p><span style="color: rgb(19, 115, 51);"> * @extends Sheet</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">class</span> <span style="color: rgb(201, 39, 134);">StudentSheet</span> <span style="color: rgb(24, 90, 188);">extends</span> <span style="color: rgb(201, 39, 134);">Sheet</span> {</p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * get student sheet data</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {array} sheet - all sheets in active spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {object} sheet - first sheet (student info) in active spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {array} students - all needed student info from sheet</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(24, 90, 188);">constructor</span>(<span style="color: rgb(32, 33, 36);">sheet</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">super</span>(<span style="color: rgb(32, 33, 36);">sheet</span>);</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>[<span style="color: rgb(9, 133, 145);">0</span>];</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">students</span> = []</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">getData</span>();</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * gets all first/last names, student numbers, and parent's emails from student sheet</span></p><p><span style="color: rgb(19, 115, 51);">   * updates 'students' property with info</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">getData</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">students</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">getRange</span>(<span style="color: rgb(9, 133, 145);">2</span>, <span style="color: rgb(9, 133, 145);">1</span>, <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">getLastRow</span>() - <span style="color: rgb(9, 133, 145);">1</span>, <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">getLastColumn</span>()).<span style="color: rgb(32, 33, 36);">getValues</span>();</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * gets student number based on row number on first page</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {number} rowNum - row number of student (starting at 0)</span></p><p><span style="color: rgb(19, 115, 51);">   * @return {string} - student number at row given</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">studentNum</span>(<span style="color: rgb(32, 33, 36);">rowNum</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">students</span>[<span style="color: rgb(32, 33, 36);">rowNum</span>][<span style="color: rgb(9, 133, 145);">2</span>];</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * gets all the student numbers on the sheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @return {array} numbers - all the student numbers</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">studentNumbers</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">numbers</span> = [];</p><p>    <span style="color: rgb(24, 90, 188);">for</span>(<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">i</span> = <span style="color: rgb(9, 133, 145);">0</span>; <span style="color: rgb(32, 33, 36);">i</span> &lt; <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">length</span>; <span style="color: rgb(32, 33, 36);">i</span>++) {</p><p>      <span style="color: rgb(32, 33, 36);">numbers</span>.<span style="color: rgb(32, 33, 36);">push</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">students</span>[<span style="color: rgb(32, 33, 36);">i</span>][<span style="color: rgb(9, 133, 145);">2</span>]);</p><p>    }</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(32, 33, 36);">numbers</span>;</p><p>  }</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * class for the sheet with course information (second sheet)</span></p><p><span style="color: rgb(19, 115, 51);"> * @extends Sheet</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">class</span> <span style="color: rgb(201, 39, 134);">CourseSheet</span> <span style="color: rgb(24, 90, 188);">extends</span> <span style="color: rgb(201, 39, 134);">Sheet</span> {</p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * get course sheet data</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {array} sheet - all sheets in active spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {object} sheet - second sheet (course info) in active spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {array} weights - all the course weightings</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(24, 90, 188);">constructor</span>(<span style="color: rgb(32, 33, 36);">sheet</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">super</span>(<span style="color: rgb(32, 33, 36);">sheet</span>);</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>[<span style="color: rgb(9, 133, 145);">1</span>];</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">weights</span> = [];</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">getData</span>();</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * gets all the course weightings</span></p><p><span style="color: rgb(19, 115, 51);">   * updates 'weights' property with info</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">getData</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">for</span>(<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">i</span> = <span style="color: rgb(9, 133, 145);">0</span>; <span style="color: rgb(32, 33, 36);">i</span> &lt; <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">getLastRow</span>() - <span style="color: rgb(9, 133, 145);">1</span>; <span style="color: rgb(32, 33, 36);">i</span>++) {</p><p>      <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">weights</span>.<span style="color: rgb(32, 33, 36);">push</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">getRange</span>(<span style="color: rgb(32, 33, 36);">i</span> + <span style="color: rgb(9, 133, 145);">2</span>, <span style="color: rgb(9, 133, 145);">2</span>).<span style="color: rgb(32, 33, 36);">getValue</span>());</p><p>    }</p><p>  }</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * class for the sheets with assessment information (after second sheet)</span></p><p><span style="color: rgb(19, 115, 51);"> * @extends Sheet</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">class</span> <span style="color: rgb(201, 39, 134);">AssessmentSheet</span> <span style="color: rgb(24, 90, 188);">extends</span> <span style="color: rgb(201, 39, 134);">Sheet</span> {</p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * get assessment sheets data</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {array} sheet - all sheets in active spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {object} sheet - sheets after second sheet (assessment info) in active spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {array} assessments - all needed assessment info from sheet</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(24, 90, 188);">constructor</span>(<span style="color: rgb(32, 33, 36);">sheet</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">super</span>(<span style="color: rgb(32, 33, 36);">sheet</span>);</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">slice</span>(<span style="color: rgb(9, 133, 145);">2</span>);</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span> = [];</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">getData</span>();</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * gets all max values, assessment weights, and grades for all assessments</span></p><p><span style="color: rgb(19, 115, 51);">   * updates 'assessments' property with info</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">getData</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">for</span>(<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">i</span> = <span style="color: rgb(9, 133, 145);">0</span>; <span style="color: rgb(32, 33, 36);">i</span> &lt; <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">length</span>; <span style="color: rgb(32, 33, 36);">i</span>++) {</p><p>      <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">push</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>[<span style="color: rgb(32, 33, 36);">i</span>].<span style="color: rgb(32, 33, 36);">getRange</span>(<span style="color: rgb(9, 133, 145);">2</span>, <span style="color: rgb(9, 133, 145);">2</span>, <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>[<span style="color: rgb(9, 133, 145);">0</span>].<span style="color: rgb(32, 33, 36);">getLastRow</span>() - <span style="color: rgb(9, 133, 145);">1</span>, <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>[<span style="color: rgb(9, 133, 145);">0</span>].<span style="color: rgb(32, 33, 36);">getLastColumn</span>() - <span style="color: rgb(9, 133, 145);">1</span>).<span style="color: rgb(32, 33, 36);">getValues</span>());</p><p>    }</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * gets all the grades in every assessment</span></p><p><span style="color: rgb(19, 115, 51);">   * @return {array} - all students' grades from all assessments</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">allGrades</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">map</span>(<span style="color: rgb(32, 33, 36);">assessment</span> =&gt; <span style="color: rgb(32, 33, 36);">assessment</span>.<span style="color: rgb(32, 33, 36);">slice</span>(-(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>[<span style="color: rgb(9, 133, 145);">0</span>].<span style="color: rgb(32, 33, 36);">length</span> - <span style="color: rgb(9, 133, 145);">4</span>)));</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * gets max values for a given assessment</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {number} page - page of assessment (starting from 0)</span></p><p><span style="color: rgb(19, 115, 51);">   * @return {array} - max values for the assessment</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">maxValues</span>(<span style="color: rgb(32, 33, 36);">page</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>[<span style="color: rgb(32, 33, 36);">page</span>][<span style="color: rgb(9, 133, 145);">0</span>];</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * gets weights for a given assessment</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {number} page - page of assessment (starting from 0)</span></p><p><span style="color: rgb(19, 115, 51);">   * @return {array} - weights for the assessment</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">weights</span>(<span style="color: rgb(32, 33, 36);">page</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>[<span style="color: rgb(32, 33, 36);">page</span>][<span style="color: rgb(9, 133, 145);">1</span>];</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * gets grades for a student in a given assessment</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {number} page - page of assessment (starting from 0)</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {number} rowNum - row number of student (starting from 0)</span></p><p><span style="color: rgb(19, 115, 51);">   * @return {array} - grades for a student in the assessment</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">grades</span>(<span style="color: rgb(32, 33, 36);">page</span>, <span style="color: rgb(32, 33, 36);">rowNum</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>[<span style="color: rgb(32, 33, 36);">page</span>][<span style="color: rgb(32, 33, 36);">rowNum</span> + <span style="color: rgb(9, 133, 145);">4</span>];</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * gets name of a given assessment</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {number} page - page of assessment (starting from 0)</span></p><p><span style="color: rgb(19, 115, 51);">   * @return {array} - name of the assessment</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">name</span>(<span style="color: rgb(32, 33, 36);">page</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>[<span style="color: rgb(32, 33, 36);">page</span>].<span style="color: rgb(32, 33, 36);">getName</span>();</p><p>  }</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * class for all sheets</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">class</span> <span style="color: rgb(201, 39, 134);">Sheets</span> {</p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * all sheet data</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {object} students - handles data from student sheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {object} course - handles data from course sheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {object} assessments - handles data from assessment sheets</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(24, 90, 188);">constructor</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">students</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">StudentSheet</span>();</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">course</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">CourseSheet</span>();</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">AssessmentSheet</span>();</p><p>  }</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * class for calculating marks/averages</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">class</span> <span style="color: rgb(201, 39, 134);">Marks</span> {</p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * uses Sheets class to get data</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {object} sheet - all needed information from spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(24, 90, 188);">constructor</span>(<span style="color: rgb(32, 33, 36);">sheet</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span> = <span style="color: rgb(32, 33, 36);">sheet</span>;</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * calculates sum of all assessment weights per category</span></p><p><span style="color: rgb(19, 115, 51);">   * @return {array} - total assessment weights in each category</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">totalWeight</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">weightings</span> = [<span style="color: rgb(9, 133, 145);">0</span>, <span style="color: rgb(9, 133, 145);">0</span>, <span style="color: rgb(9, 133, 145);">0</span>, <span style="color: rgb(9, 133, 145);">0</span>];</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">for</span>(<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">page</span> = <span style="color: rgb(9, 133, 145);">0</span>; <span style="color: rgb(32, 33, 36);">page</span> &lt; <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">length</span>; <span style="color: rgb(32, 33, 36);">page</span>++) {</p><p>      <span style="color: rgb(32, 33, 36);">weightings</span> = <span style="color: rgb(32, 33, 36);">weightings</span>.<span style="color: rgb(32, 33, 36);">map</span>((<span style="color: rgb(32, 33, 36);">weight</span>, <span style="color: rgb(32, 33, 36);">category</span>) =&gt; <span style="color: rgb(32, 33, 36);">weight</span> + <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">weights</span>(<span style="color: rgb(32, 33, 36);">page</span>)[<span style="color: rgb(32, 33, 36);">category</span>]);</p><p>    }</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(32, 33, 36);">weightings</span>;</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * calculates weighted averages of all given students</span></p><p><span style="color: rgb(19, 115, 51);">   * calculates every category from every assessment using: (grade/max grade x 100) * (assignment category weight/total category weight) * (course weight) and adds them together</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {number} start - row number of first student to start at (inclusive)</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {number} end - row number of last student to end at (inclusive)</span></p><p><span style="color: rgb(19, 115, 51);">   * @return {array} - weighted averages of all students from 'start' row to 'end' row</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">calcAverages</span>(<span style="color: rgb(32, 33, 36);">start</span>, <span style="color: rgb(32, 33, 36);">end</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">totalWeights</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">totalWeight</span>();</p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">assessments</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">allGrades</span>();</p><p>    <span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">averages</span> = <span style="color: rgb(201, 39, 134);">Array</span>(<span style="color: rgb(32, 33, 36);">end</span> - <span style="color: rgb(32, 33, 36);">start</span> + <span style="color: rgb(9, 133, 145);">1</span>).<span style="color: rgb(32, 33, 36);">fill</span>(<span style="color: rgb(9, 133, 145);">0</span>);</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">for</span> (<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">page</span> = <span style="color: rgb(9, 133, 145);">0</span>; <span style="color: rgb(32, 33, 36);">page</span> &lt; <span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">length</span>; <span style="color: rgb(32, 33, 36);">page</span>++) {</p><p>      <span style="color: rgb(24, 90, 188);">for</span> (<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">row</span> = <span style="color: rgb(32, 33, 36);">start</span>; <span style="color: rgb(32, 33, 36);">row</span> &lt;= <span style="color: rgb(32, 33, 36);">end</span>; <span style="color: rgb(32, 33, 36);">row</span>++) {</p><p>        <span style="color: rgb(24, 90, 188);">for</span> (<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">col</span> = <span style="color: rgb(9, 133, 145);">0</span>; <span style="color: rgb(32, 33, 36);">col</span> &lt; <span style="color: rgb(32, 33, 36);">assessments</span>[<span style="color: rgb(32, 33, 36);">page</span>][<span style="color: rgb(32, 33, 36);">row</span>].<span style="color: rgb(32, 33, 36);">length</span>; <span style="color: rgb(32, 33, 36);">col</span>++) {</p><p>          <span style="color: rgb(32, 33, 36);">averages</span>[<span style="color: rgb(32, 33, 36);">row</span> - <span style="color: rgb(32, 33, 36);">start</span>] += (<span style="color: rgb(32, 33, 36);">assessments</span>[<span style="color: rgb(32, 33, 36);">page</span>][<span style="color: rgb(32, 33, 36);">row</span>][<span style="color: rgb(32, 33, 36);">col</span>] / <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">maxValues</span>(<span style="color: rgb(32, 33, 36);">page</span>)[<span style="color: rgb(32, 33, 36);">col</span>] * <span style="color: rgb(9, 133, 145);">100</span>) * (<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">weights</span>(<span style="color: rgb(32, 33, 36);">page</span>)[<span style="color: rgb(32, 33, 36);">col</span>] / <span style="color: rgb(32, 33, 36);">totalWeights</span>[<span style="color: rgb(32, 33, 36);">col</span>]) * (<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">course</span>.<span style="color: rgb(32, 33, 36);">weights</span>[<span style="color: rgb(32, 33, 36);">col</span>] / <span style="color: rgb(9, 133, 145);">100</span>);</p><p>        }</p><p>      }</p><p>    }</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(32, 33, 36);">averages</span>;</p><p>  }</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);"> * class for the course (this spreadsheet)</span></p><p><span style="color: rgb(19, 115, 51);"> */</span></p><p><span style="color: rgb(24, 90, 188);">class</span> <span style="color: rgb(201, 39, 134);">Course</span> {</p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   * creates the course with needed info</span></p><p><span style="color: rgb(19, 115, 51);">   * @param {object} sheet - all needed information from spreadsheet</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {object} marks - used for calculations within course</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {array} averages - weighted averages of all students in course</span></p><p><span style="color: rgb(19, 115, 51);">   * @property {array} students - all students in course (as Student objects)</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(24, 90, 188);">constructor</span>(<span style="color: rgb(32, 33, 36);">sheet</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span> = <span style="color: rgb(32, 33, 36);">sheet</span>;</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">marks</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Marks</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>);</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">averages</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">marks</span>.<span style="color: rgb(32, 33, 36);">calcAverages</span>(<span style="color: rgb(9, 133, 145);">0</span>, <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">length</span> - <span style="color: rgb(9, 133, 145);">1</span>);</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">students</span> = []</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">getStudents</span>();</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(19, 115, 51);">/**</span></p><p><span style="color: rgb(19, 115, 51);">   *</span></p><p><span style="color: rgb(19, 115, 51);">   */</span></p><p>  <span style="color: rgb(32, 33, 36);">getStudents</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">for</span>(<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">i</span> = <span style="color: rgb(9, 133, 145);">0</span>; <span style="color: rgb(32, 33, 36);">i</span> &lt; <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">length</span>; <span style="color: rgb(32, 33, 36);">i</span>++) {</p><p>      <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">push</span>(<span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Student</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">studentNum</span>(<span style="color: rgb(32, 33, 36);">i</span>), <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>));</p><p>      <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">students</span>[<span style="color: rgb(32, 33, 36);">i</span>].<span style="color: rgb(32, 33, 36);">weightedAverage</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">averages</span>[<span style="color: rgb(32, 33, 36);">i</span>];</p><p>    }</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">getHighestMark</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">highest</span> = [<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">averages</span>[<span style="color: rgb(9, 133, 145);">0</span>], <span style="color: rgb(9, 133, 145);">0</span>]; <span style="color: rgb(95, 99, 104);">// [average, row num]</span></p><p>    <span style="color: rgb(24, 90, 188);">for</span>(<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">i</span> = <span style="color: rgb(9, 133, 145);">1</span>; <span style="color: rgb(32, 33, 36);">i</span> &lt; <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">averages</span>.<span style="color: rgb(32, 33, 36);">length</span>; <span style="color: rgb(32, 33, 36);">i</span>++) {</p><p>      <span style="color: rgb(24, 90, 188);">if</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">averages</span>[<span style="color: rgb(32, 33, 36);">i</span>] &gt; <span style="color: rgb(32, 33, 36);">highest</span>[<span style="color: rgb(9, 133, 145);">0</span>]) {</p><p>        <span style="color: rgb(32, 33, 36);">highest</span> = [<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">averages</span>[<span style="color: rgb(32, 33, 36);">i</span>], <span style="color: rgb(32, 33, 36);">i</span>];</p><p>      }</p><p>    }</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">students</span>[<span style="color: rgb(32, 33, 36);">highest</span>[<span style="color: rgb(9, 133, 145);">1</span>]];</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">getLowestMark</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">lowest</span> = [<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">averages</span>[<span style="color: rgb(9, 133, 145);">0</span>], <span style="color: rgb(9, 133, 145);">0</span>];</p><p>    <span style="color: rgb(24, 90, 188);">for</span>(<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">i</span> = <span style="color: rgb(9, 133, 145);">1</span>; <span style="color: rgb(32, 33, 36);">i</span> &lt; <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">averages</span>.<span style="color: rgb(32, 33, 36);">length</span>; <span style="color: rgb(32, 33, 36);">i</span>++) {</p><p>      <span style="color: rgb(24, 90, 188);">if</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">averages</span>[<span style="color: rgb(32, 33, 36);">i</span>] &lt; <span style="color: rgb(32, 33, 36);">lowest</span>[<span style="color: rgb(9, 133, 145);">0</span>]) {</p><p>        <span style="color: rgb(32, 33, 36);">lowest</span> = [<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">averages</span>[<span style="color: rgb(32, 33, 36);">i</span>], <span style="color: rgb(32, 33, 36);">i</span>];</p><p>      }</p><p>    }</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">students</span>[<span style="color: rgb(32, 33, 36);">lowest</span>[<span style="color: rgb(9, 133, 145);">1</span>]];</p><p>  }</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(24, 90, 188);">class</span> <span style="color: rgb(201, 39, 134);">Student</span> {</p><p>  <span style="color: rgb(24, 90, 188);">constructor</span>(<span style="color: rgb(32, 33, 36);">number</span>, <span style="color: rgb(32, 33, 36);">sheet</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">number</span> = <span style="color: rgb(32, 33, 36);">number</span>;</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span> = <span style="color: rgb(32, 33, 36);">sheet</span>;</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rowNum</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">getRowNum</span>();</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">marks</span> = <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Marks</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>);</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">weightedAverage</span> = <span style="color: rgb(24, 90, 188);">null</span>;</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rawAverage</span> = <span style="color: rgb(24, 90, 188);">null</span>;</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span> = <span style="color: rgb(24, 90, 188);">null</span>;</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">getRowNum</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">createTextFinder</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">number</span>).<span style="color: rgb(32, 33, 36);">findNext</span>().<span style="color: rgb(32, 33, 36);">getRow</span>() - <span style="color: rgb(9, 133, 145);">2</span>;</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">fullname</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(179, 20, 18);">`</span>${<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">students</span>[<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rowNum</span>][<span style="color: rgb(9, 133, 145);">0</span>]}<span style="color: rgb(179, 20, 18);"> </span>${<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">students</span>[<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rowNum</span>][<span style="color: rgb(9, 133, 145);">1</span>]}<span style="color: rgb(179, 20, 18);">`</span>;</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">email</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">students</span>[<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rowNum</span>][<span style="color: rgb(9, 133, 145);">3</span>];</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">getWeightedAverage</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">if</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">weightedAverage</span> === <span style="color: rgb(24, 90, 188);">null</span>) {</p><p>      <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">weightedAverage</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">marks</span>.<span style="color: rgb(32, 33, 36);">calcAverages</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rowNum</span>, <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rowNum</span>)[<span style="color: rgb(9, 133, 145);">0</span>];</p><p>    }</p><p>  </p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">weightedAverage</span>;</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">getRawAverage</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">if</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span> === <span style="color: rgb(24, 90, 188);">null</span>) {</p><p>      <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessmentGrades</span>();</p><p>    }</p><p>    <span style="color: rgb(24, 90, 188);">if</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rawAverage</span> === <span style="color: rgb(24, 90, 188);">null</span>) {</p><p>      <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rawAverage</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>[<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">length</span> - <span style="color: rgb(9, 133, 145);">1</span>].<span style="color: rgb(32, 33, 36);">slice</span>(<span style="color: rgb(9, 133, 145);">1</span>).<span style="color: rgb(32, 33, 36);">reduce</span>((<span style="color: rgb(32, 33, 36);">average</span>, <span style="color: rgb(32, 33, 36);">grade</span>) =&gt; <span style="color: rgb(32, 33, 36);">average</span> + <span style="color: rgb(32, 33, 36);">grade</span>) / <span style="color: rgb(9, 133, 145);">4</span>;</p><p>    }</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rawAverage</span>;</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">assessmentGrades</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span> = [[<span style="color: rgb(179, 20, 18);">"Assessments"</span>, <span style="color: rgb(179, 20, 18);">"K"</span>, <span style="color: rgb(179, 20, 18);">"T"</span>,<span style="color: rgb(179, 20, 18);">"C"</span>,<span style="color: rgb(179, 20, 18);">"A"</span>]];</p><p>    <span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">totalGrade</span> = [<span style="color: rgb(9, 133, 145);">0</span>, <span style="color: rgb(9, 133, 145);">0</span>, <span style="color: rgb(9, 133, 145);">0</span>, <span style="color: rgb(9, 133, 145);">0</span>];</p><p>    <span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">totalMaxValues</span> = [<span style="color: rgb(9, 133, 145);">0</span>, <span style="color: rgb(9, 133, 145);">0</span>, <span style="color: rgb(9, 133, 145);">0</span>, <span style="color: rgb(9, 133, 145);">0</span>];</p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">assessments</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">assessments</span>;</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">for</span>(<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">row</span> = <span style="color: rgb(9, 133, 145);">0</span>; <span style="color: rgb(32, 33, 36);">row</span> &lt; <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">length</span>; <span style="color: rgb(32, 33, 36);">row</span>++) { <span style="color: rgb(95, 99, 104);">// table row / sheet page</span></p><p>      <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">push</span>([<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">name</span>(<span style="color: rgb(32, 33, 36);">row</span>)]);</p><p>      <span style="color: rgb(24, 90, 188);">for</span>(<span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">col</span> = <span style="color: rgb(9, 133, 145);">0</span>; <span style="color: rgb(32, 33, 36);">col</span> &lt; <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">assessments</span>[<span style="color: rgb(32, 33, 36);">row</span>][<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rowNum</span>].<span style="color: rgb(32, 33, 36);">length</span>; <span style="color: rgb(32, 33, 36);">col</span>++) { <span style="color: rgb(95, 99, 104);">// table column / assessment category</span></p><p>        <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>[<span style="color: rgb(32, 33, 36);">row</span> + <span style="color: rgb(9, 133, 145);">1</span>].<span style="color: rgb(32, 33, 36);">push</span>(<span style="color: rgb(179, 20, 18);">`</span>${<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">grades</span>(<span style="color: rgb(32, 33, 36);">row</span>, <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rowNum</span>)[<span style="color: rgb(32, 33, 36);">col</span>]}<span style="color: rgb(179, 20, 18);"> / </span>${<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">maxValues</span>(<span style="color: rgb(32, 33, 36);">row</span>)[<span style="color: rgb(32, 33, 36);">col</span>]}<span style="color: rgb(179, 20, 18);">`</span>);</p><p>        <span style="color: rgb(32, 33, 36);">totalGrade</span>[<span style="color: rgb(32, 33, 36);">col</span>] += <span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">grades</span>(<span style="color: rgb(32, 33, 36);">row</span>, <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">rowNum</span>)[<span style="color: rgb(32, 33, 36);">col</span>];</p><p>        <span style="color: rgb(32, 33, 36);">totalMaxValues</span>[<span style="color: rgb(32, 33, 36);">col</span>] += <span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">maxValues</span>(<span style="color: rgb(32, 33, 36);">row</span>)[<span style="color: rgb(32, 33, 36);">col</span>];</p><p>      }</p><p>    }</p><p><br></p><p><br></p><p>    <span style="color: rgb(32, 33, 36);">totalGrade</span> = <span style="color: rgb(32, 33, 36);">totalGrade</span>.<span style="color: rgb(32, 33, 36);">map</span>((<span style="color: rgb(32, 33, 36);">grade</span>, <span style="color: rgb(32, 33, 36);">category</span>) =&gt; <span style="color: rgb(201, 39, 134);">Math</span>.<span style="color: rgb(32, 33, 36);">round</span>(<span style="color: rgb(32, 33, 36);">grade</span> / <span style="color: rgb(32, 33, 36);">totalMaxValues</span>[<span style="color: rgb(32, 33, 36);">category</span>] * <span style="color: rgb(9, 133, 145);">1000</span>) / <span style="color: rgb(9, 133, 145);">10</span>);</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">push</span>([<span style="color: rgb(179, 20, 18);">"Raw Average:"</span>, ...<span style="color: rgb(32, 33, 36);">totalGrade</span>]);</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">assessments</span>;</p><p>  }</p><p>   <span style="color: rgb(32, 33, 36);">showInfo</span>(<span style="color: rgb(32, 33, 36);">title</span>) {</p><p>    <span style="color: rgb(201, 39, 134);">SpreadsheetApp</span>.<span style="color: rgb(32, 33, 36);">getUi</span>().<span style="color: rgb(32, 33, 36);">alert</span>(<span style="color: rgb(32, 33, 36);">title</span>, <span style="color: rgb(179, 20, 18);">`Name: </span>${<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">fullname</span>()}<span style="color: rgb(179, 20, 18);"> \n Weighted Average: </span>${<span style="color: rgb(201, 39, 134);">Math</span>.<span style="color: rgb(32, 33, 36);">round</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">weightedAverage</span> * <span style="color: rgb(9, 133, 145);">10</span>) / <span style="color: rgb(9, 133, 145);">10</span>}<span style="color: rgb(179, 20, 18);">%`</span>, <span style="color: rgb(201, 39, 134);">SpreadsheetApp</span>.<span style="color: rgb(32, 33, 36);">getUi</span>().<span style="color: rgb(201, 39, 134);">ButtonSet</span>.<span style="color: rgb(201, 39, 134);">OK</span>);</p><p>  }</p><p>}</p><p><br></p><p><br></p><p><span style="color: rgb(24, 90, 188);">class</span> <span style="color: rgb(201, 39, 134);">Report</span> {</p><p>  <span style="color: rgb(24, 90, 188);">constructor</span>(<span style="color: rgb(32, 33, 36);">sheet</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span> = <span style="color: rgb(32, 33, 36);">sheet</span>;</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">getStudent</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">studentNum</span> = <span style="color: rgb(201, 39, 134);">SpreadsheetApp</span>.<span style="color: rgb(32, 33, 36);">getUi</span>().<span style="color: rgb(32, 33, 36);">prompt</span>(<span style="color: rgb(179, 20, 18);">"Please enter the student number"</span>).<span style="color: rgb(32, 33, 36);">getResponseText</span>();</p><p>  </p><p>    <span style="color: rgb(24, 90, 188);">if</span>(<span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>.<span style="color: rgb(32, 33, 36);">students</span>.<span style="color: rgb(32, 33, 36);">studentNumbers</span>().<span style="color: rgb(32, 33, 36);">includes</span>(<span style="color: rgb(32, 33, 36);">parseInt</span>(<span style="color: rgb(32, 33, 36);">studentNum</span>))) {</p><p>      <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">new</span> <span style="color: rgb(201, 39, 134);">Student</span>(<span style="color: rgb(32, 33, 36);">studentNum</span>, <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">sheet</span>);</p><p>    }</p><p>    <span style="color: rgb(24, 90, 188);">else</span> <span style="color: rgb(24, 90, 188);">if</span>(<span style="color: rgb(32, 33, 36);">studentNum</span> !== <span style="color: rgb(179, 20, 18);">""</span>) {</p><p>      <span style="color: rgb(201, 39, 134);">SpreadsheetApp</span>.<span style="color: rgb(32, 33, 36);">getUi</span>().<span style="color: rgb(32, 33, 36);">alert</span>(<span style="color: rgb(179, 20, 18);">"Sorry, that is not a valid student number"</span>);</p><p>    }</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(24, 90, 188);">null</span>;</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">create</span>(<span style="color: rgb(32, 33, 36);">student</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">report</span> = <span style="color: rgb(201, 39, 134);">DocumentApp</span>.<span style="color: rgb(32, 33, 36);">create</span>(<span style="color: rgb(179, 20, 18);">`</span>${<span style="color: rgb(32, 33, 36);">student</span>.<span style="color: rgb(32, 33, 36);">fullname</span>()}<span style="color: rgb(179, 20, 18);"> - Student Report`</span>);</p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">body</span> = <span style="color: rgb(32, 33, 36);">report</span>.<span style="color: rgb(32, 33, 36);">getBody</span>();</p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">assessments</span> = <span style="color: rgb(32, 33, 36);">student</span>.<span style="color: rgb(32, 33, 36);">assessmentGrades</span>()</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">let</span> <span style="color: rgb(32, 33, 36);">bold</span> = {};</p><p>    <span style="color: rgb(32, 33, 36);">bold</span>[<span style="color: rgb(201, 39, 134);">DocumentApp</span>.<span style="color: rgb(201, 39, 134);">Attribute</span>.<span style="color: rgb(201, 39, 134);">BOLD</span>] = <span style="color: rgb(24, 90, 188);">true</span>;</p><p><br></p><p><br></p><p>    <span style="color: rgb(32, 33, 36);">body</span>.<span style="color: rgb(32, 33, 36);">editAsText</span>().<span style="color: rgb(32, 33, 36);">setFontSize</span>(<span style="color: rgb(9, 133, 145);">0</span>);</p><p><br></p><p><br></p><p>    <span style="color: rgb(32, 33, 36);">body</span>.<span style="color: rgb(32, 33, 36);">appendParagraph</span>(<span style="color: rgb(179, 20, 18);">`STUDENT REPORT - </span>${<span style="color: rgb(32, 33, 36);">student</span>.<span style="color: rgb(32, 33, 36);">fullname</span>()}<span style="color: rgb(179, 20, 18);">`</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setHeading</span>(<span style="color: rgb(201, 39, 134);">DocumentApp</span>.<span style="color: rgb(201, 39, 134);">ParagraphHeading</span>.<span style="color: rgb(201, 39, 134);">HEADING1</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setSpacingBefore</span>(<span style="color: rgb(9, 133, 145);">0</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setAttributes</span>(<span style="color: rgb(32, 33, 36);">bold</span>);</p><p>    <span style="color: rgb(32, 33, 36);">body</span>.<span style="color: rgb(32, 33, 36);">appendParagraph</span>(<span style="color: rgb(179, 20, 18);">`Weighted Average: </span>${<span style="color: rgb(201, 39, 134);">Math</span>.<span style="color: rgb(32, 33, 36);">round</span>(<span style="color: rgb(32, 33, 36);">student</span>.<span style="color: rgb(32, 33, 36);">getWeightedAverage</span>() * <span style="color: rgb(9, 133, 145);">10</span>) / <span style="color: rgb(9, 133, 145);">10</span>}<span style="color: rgb(179, 20, 18);">%`</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setHeading</span>(<span style="color: rgb(201, 39, 134);">DocumentApp</span>.<span style="color: rgb(201, 39, 134);">ParagraphHeading</span>.<span style="color: rgb(201, 39, 134);">HEADING2</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setSpacingBefore</span>(<span style="color: rgb(9, 133, 145);">0</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setSpacingAfter</span>(<span style="color: rgb(9, 133, 145);">0</span>);</p><p>    <span style="color: rgb(32, 33, 36);">body</span>.<span style="color: rgb(32, 33, 36);">appendParagraph</span>(<span style="color: rgb(179, 20, 18);">`Raw Average: </span>${<span style="color: rgb(201, 39, 134);">Math</span>.<span style="color: rgb(32, 33, 36);">round</span>(<span style="color: rgb(32, 33, 36);">student</span>.<span style="color: rgb(32, 33, 36);">getRawAverage</span>() * <span style="color: rgb(9, 133, 145);">10</span>) / <span style="color: rgb(9, 133, 145);">10</span>}<span style="color: rgb(179, 20, 18);">%`</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setHeading</span>(<span style="color: rgb(201, 39, 134);">DocumentApp</span>.<span style="color: rgb(201, 39, 134);">ParagraphHeading</span>.<span style="color: rgb(201, 39, 134);">HEADING2</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setSpacingBefore</span>(<span style="color: rgb(9, 133, 145);">0</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setSpacingAfter</span>(<span style="color: rgb(9, 133, 145);">20</span>);</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">table</span> = <span style="color: rgb(32, 33, 36);">body</span>.<span style="color: rgb(32, 33, 36);">appendTable</span>(<span style="color: rgb(32, 33, 36);">assessments</span>);</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">chartData</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">createChart</span>(<span style="color: rgb(32, 33, 36);">assessments</span>[<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">length</span> - <span style="color: rgb(9, 133, 145);">1</span>]).<span style="color: rgb(32, 33, 36);">getAs</span>(<span style="color: rgb(179, 20, 18);">'image/png'</span>).<span style="color: rgb(32, 33, 36);">copyBlob</span>();</p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">chart</span> = <span style="color: rgb(32, 33, 36);">body</span>.<span style="color: rgb(32, 33, 36);">appendImage</span>(<span style="color: rgb(32, 33, 36);">chartData</span>);</p><p>  </p><p>    <span style="color: rgb(32, 33, 36);">table</span>.<span style="color: rgb(32, 33, 36);">getRow</span>(<span style="color: rgb(9, 133, 145);">0</span>).<span style="color: rgb(32, 33, 36);">setAttributes</span>(<span style="color: rgb(32, 33, 36);">bold</span>);</p><p>    <span style="color: rgb(32, 33, 36);">table</span>.<span style="color: rgb(32, 33, 36);">getRow</span>(<span style="color: rgb(32, 33, 36);">assessments</span>.<span style="color: rgb(32, 33, 36);">length</span> - <span style="color: rgb(9, 133, 145);">1</span>).<span style="color: rgb(32, 33, 36);">setAttributes</span>(<span style="color: rgb(32, 33, 36);">bold</span>);</p><p>    <span style="color: rgb(32, 33, 36);">body</span>.<span style="color: rgb(32, 33, 36);">setFontFamily</span>(<span style="color: rgb(179, 20, 18);">"Nunito"</span>);</p><p>  </p><p>    <span style="color: rgb(32, 33, 36);">report</span>.<span style="color: rgb(32, 33, 36);">saveAndClose</span>();</p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(32, 33, 36);">report</span>.<span style="color: rgb(32, 33, 36);">getUrl</span>();</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">createChart</span>(<span style="color: rgb(32, 33, 36);">grades</span>) {</p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">data</span> = <span style="color: rgb(201, 39, 134);">Charts</span>.<span style="color: rgb(32, 33, 36);">newDataTable</span>()</p><p>      .<span style="color: rgb(32, 33, 36);">addColumn</span>(<span style="color: rgb(201, 39, 134);">Charts</span>.<span style="color: rgb(201, 39, 134);">ColumnType</span>.<span style="color: rgb(201, 39, 134);">STRING</span>, <span style="color: rgb(179, 20, 18);">"Category"</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">addColumn</span>(<span style="color: rgb(201, 39, 134);">Charts</span>.<span style="color: rgb(201, 39, 134);">ColumnType</span>.<span style="color: rgb(201, 39, 134);">NUMBER</span>, <span style="color: rgb(179, 20, 18);">"Average"</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">addRow</span>([<span style="color: rgb(179, 20, 18);">"K"</span>, <span style="color: rgb(32, 33, 36);">grades</span>[<span style="color: rgb(9, 133, 145);">1</span>]])</p><p>      .<span style="color: rgb(32, 33, 36);">addRow</span>([<span style="color: rgb(179, 20, 18);">"T"</span>, <span style="color: rgb(32, 33, 36);">grades</span>[<span style="color: rgb(9, 133, 145);">2</span>]])</p><p>      .<span style="color: rgb(32, 33, 36);">addRow</span>([<span style="color: rgb(179, 20, 18);">"C"</span>, <span style="color: rgb(32, 33, 36);">grades</span>[<span style="color: rgb(9, 133, 145);">3</span>]])</p><p>      .<span style="color: rgb(32, 33, 36);">addRow</span>([<span style="color: rgb(179, 20, 18);">"A"</span>, <span style="color: rgb(32, 33, 36);">grades</span>[<span style="color: rgb(9, 133, 145);">4</span>]])</p><p>      .<span style="color: rgb(32, 33, 36);">build</span>();</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">chart</span> = <span style="color: rgb(201, 39, 134);">Charts</span>.<span style="color: rgb(32, 33, 36);">newBarChart</span>()</p><p>      .<span style="color: rgb(32, 33, 36);">setDataTable</span>(<span style="color: rgb(32, 33, 36);">data</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setTitle</span>(<span style="color: rgb(179, 20, 18);">"Student Averages"</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setXAxisTitle</span>(<span style="color: rgb(179, 20, 18);">"Average (%)"</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setYAxisTitle</span>(<span style="color: rgb(179, 20, 18);">"Category"</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setLegendPosition</span>(<span style="color: rgb(201, 39, 134);">Charts</span>.<span style="color: rgb(201, 39, 134);">Position</span>.<span style="color: rgb(201, 39, 134);">NONE</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setRange</span>(<span style="color: rgb(9, 133, 145);">0</span>, <span style="color: rgb(9, 133, 145);">100</span>)</p><p>      .<span style="color: rgb(32, 33, 36);">setDimensions</span>(<span style="color: rgb(9, 133, 145);">625</span>, <span style="color: rgb(9, 133, 145);">300</span>) </p><p>      .<span style="color: rgb(32, 33, 36);">setColors</span>([<span style="color: rgb(179, 20, 18);">"#629DBA"</span>])</p><p>      .<span style="color: rgb(32, 33, 36);">build</span>()</p><p><br></p><p><br></p><p>    <span style="color: rgb(24, 90, 188);">return</span> <span style="color: rgb(32, 33, 36);">chart</span>;</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">createReport</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">student</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">getStudent</span>();</p><p>    <span style="color: rgb(24, 90, 188);">if</span>(<span style="color: rgb(32, 33, 36);">student</span> !== <span style="color: rgb(24, 90, 188);">null</span>) {</p><p>      <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">url</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">create</span>(<span style="color: rgb(32, 33, 36);">student</span>);</p><p>      <span style="color: rgb(201, 39, 134);">SpreadsheetApp</span>.<span style="color: rgb(32, 33, 36);">getUi</span>().<span style="color: rgb(32, 33, 36);">alert</span>(<span style="color: rgb(179, 20, 18);">`Student Report for </span>${<span style="color: rgb(32, 33, 36);">student</span>.<span style="color: rgb(32, 33, 36);">fullname</span>()}<span style="color: rgb(179, 20, 18);">: \n</span>${<span style="color: rgb(32, 33, 36);">url</span>}<span style="color: rgb(179, 20, 18);">`</span>);</p><p>    }</p><p>  }</p><p><br></p><p><br></p><p>  <span style="color: rgb(32, 33, 36);">mailReport</span>() {</p><p>    <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">student</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">getStudent</span>();</p><p>    <span style="color: rgb(24, 90, 188);">if</span>(<span style="color: rgb(32, 33, 36);">student</span> !== <span style="color: rgb(24, 90, 188);">null</span>) {</p><p>      <span style="color: rgb(24, 90, 188);">const</span> <span style="color: rgb(32, 33, 36);">url</span> = <span style="color: rgb(24, 90, 188);">this</span>.<span style="color: rgb(32, 33, 36);">create</span>(<span style="color: rgb(32, 33, 36);">student</span>);</p><p><br></p><p><br></p><p>      <span style="color: rgb(201, 39, 134);">MailApp</span>.<span style="color: rgb(32, 33, 36);">sendEmail</span>({</p><p>        <span style="color: rgb(32, 33, 36);">to</span>: <span style="color: rgb(32, 33, 36);">student</span>.<span style="color: rgb(32, 33, 36);">email</span>(),</p><p>        <span style="color: rgb(32, 33, 36);">subject</span>: <span style="color: rgb(179, 20, 18);">`</span>${<span style="color: rgb(32, 33, 36);">student</span>.<span style="color: rgb(32, 33, 36);">fullname</span>()}<span style="color: rgb(179, 20, 18);"> - Student Report`</span>,</p><p>        <span style="color: rgb(32, 33, 36);">htmlBody</span>: <span style="color: rgb(179, 20, 18);">`</span></p><p><span style="color: rgb(179, 20, 18);">          &lt;p&gt;</span></p><p><span style="color: rgb(179, 20, 18);">          Hello guardians of </span>${<span style="color: rgb(32, 33, 36);">student</span>.<span style="color: rgb(32, 33, 36);">fullname</span>()}<span style="color: rgb(179, 20, 18);">,</span></p><p><span style="color: rgb(179, 20, 18);">          &lt;/p&gt;</span></p><p><br></p><p><br></p><p><span style="color: rgb(179, 20, 18);">          &lt;p&gt;</span></p><p><span style="color: rgb(179, 20, 18);">          Here is a student report for your child: </span>${<span style="color: rgb(32, 33, 36);">url</span>}</p><p><span style="color: rgb(179, 20, 18);">          &lt;/p&gt;</span></p><p><br></p><p><br></p><p><span style="color: rgb(179, 20, 18);">          &lt;p&gt;</span></p><p><span style="color: rgb(179, 20, 18);">          Thank you</span></p><p><span style="color: rgb(179, 20, 18);">          &lt;/p&gt;</span></p><p><span style="color: rgb(179, 20, 18);">        `</span></p><p>      })</p><p><br></p><p><br></p><p>      <span style="color: rgb(201, 39, 134);">SpreadsheetApp</span>.<span style="color: rgb(32, 33, 36);">getUi</span>().<span style="color: rgb(32, 33, 36);">alert</span>(<span style="color: rgb(179, 20, 18);">`Email sent to the guardians of </span>${<span style="color: rgb(32, 33, 36);">student</span>.<span style="color: rgb(32, 33, 36);">fullname</span>()}<span style="color: rgb(179, 20, 18);">`</span>);</p><p>    }</p><p>  }</p><p>}</p><p><br></p>